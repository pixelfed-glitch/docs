import{_ as o,E as n,c as l,m as e,a as i,J as a,V as t,o as r}from"./chunks/framework.wUJtDaaB.js";const Me=JSON.parse('{"title":"Migrate to the Pixelfed + Docker Compose v2","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"running-pixelfed/docker/migrate/v2.0.md","filePath":"running-pixelfed/docker/migrate/v2.0.md"}'),h={name:"running-pixelfed/docker/migrate/v2.0.md"},d=t("",7),p={id:"new-dockerfile",tabindex:"-1"},c=e("code",null,"Dockerfile",-1),k=e("a",{class:"header-anchor",href:"#new-dockerfile","aria-label":'Permalink to "New `Dockerfile` <Badge type="danger" text="Breaking" />"'},"​",-1),u=e("p",null,[i("All "),e("a",{href:"./../runtimes.html"},"runtime variations"),i(" of Pixelfed on Docker are now build from a single "),e("code",null,"Dockerfile"),i(", rather than the previously three.")],-1),g=e("p",null,[i("Please see the "),e("a",{href:"./../runtimes.html"},"Docker Runtimes"),i(" and "),e("a",{href:"./../customize.html"},"Docker Customization"),i(" documentation for more information.")],-1),m={id:"new-docker-compose-file",tabindex:"-1"},y=e("a",{class:"header-anchor",href:"#new-docker-compose-file","aria-label":'Permalink to "New Docker Compose file <Badge type="danger" text="Breaking" />"'},"​",-1),f=e("p",null,[i("The "),e("code",null,"docker-compose.yml"),i(" file has been rewritten from the ground up to be provide better defaults and more flexible out of the box.")],-1),b=e("p",null,[i("This mean that "),e("em",null,"most"),i(" things you would likely want to tweak can be controlled from your "),e("code",null,".env"),i(" config file, like installing additional APT Packages, PECL/PHP extensions, changing PHP version, modifying PHP settings (such as "),e("code",null,"memory_limit"),i("), disabling specific services, changing where data and config files are stored, and so on.")],-1),F={id:"new-env-env-docker-file",tabindex:"-1"},_=e("code",null,".env",-1),v=e("code",null,".env.docker",-1),C=e("a",{class:"header-anchor",href:"#new-env-env-docker-file","aria-label":'Permalink to "New `.env` / `.env.docker` file <Badge type="danger" text="Breaking" />"'},"​",-1),w=e("p",null,[i("The starter "),e("code",null,".env.docker"),i(" file has been "),e("em",null,"significantly"),i(" expanded with most of the Pixelfed settings available, along with many Docker Compose specific ones.")],-1),E=e("p",null,[i("Your Pixelfed specific settings are (of course) unchanged, but you need to configure them again after copying the new "),e("code",null,".env.docker"),i(" file.")],-1),B={id:"using-bind-volumes",tabindex:"-1"},T=e("code",null,"bind",-1),P=e("a",{class:"header-anchor",href:"#using-bind-volumes","aria-label":'Permalink to "Using `bind` volumes <Badge type="danger" text="Breaking" />"'},"​",-1),x=t("",5),A={id:"no-docker-networks",tabindex:"-1"},D=e("a",{class:"header-anchor",href:"#no-docker-networks","aria-label":'Permalink to "No Docker networks <Badge type="danger" text="Breaking change" />"'},"​",-1),O=t("",4),N={id:"new-redis-version",tabindex:"-1"},R=e("a",{class:"header-anchor",href:"#new-redis-version","aria-label":'Permalink to "New Redis version <Badge type="warning" text="Attention needed" />"'},"​",-1),I=t("",4),S={id:"pinned-mariadb-version",tabindex:"-1"},q=e("a",{class:"header-anchor",href:"#pinned-mariadb-version","aria-label":'Permalink to "Pinned MariaDB version <Badge type="warning" text="Attention needed" />"'},"​",-1),H=e("p",null,[i("The included "),e("code",null,"db"),i(" service is now pinned to MariaDB "),e("code",null,"11.2"),i(" instead of "),e("code",null,"latest"),i(".")],-1),L=e("p",null,[i("You can revert to the previous setting by setting "),e("code",null,'DB_VERSION="latest"'),i(" in your "),e("code",null,".env"),i(" file.")],-1),M={id:"automatic-one-time-setup-tasks",tabindex:"-1"},V=e("a",{class:"header-anchor",href:"#automatic-one-time-setup-tasks","aria-label":'Permalink to "Automatic "One-time setup tasks" <Badge type="warning" text="Attention needed" />"'},"​",-1),K=t("",4),z={id:"nginx-proxy-service",tabindex:"-1"},U=e("a",{class:"header-anchor",href:"#nginx-proxy-service","aria-label":'Permalink to "Nginx Proxy service <Badge type="tip" text="New" />"'},"​",-1),W=t("",2),G={id:"letsencrypt-acme-service",tabindex:"-1"},Y=e("a",{class:"header-anchor",href:"#letsencrypt-acme-service","aria-label":'Permalink to "LetsEncrypt/ACME service <Badge type="tip" text="New" />"'},"​",-1),$=t("",2),j={id:"automatic-run-of-one-time-setup-tasks",tabindex:"-1"},X=e("a",{class:"header-anchor",href:"#automatic-run-of-one-time-setup-tasks","aria-label":'Permalink to "Automatic run of "One-time setup tasks" <Badge type="tip" text="New" />"'},"​",-1),Z=e("p",null,[i("When you set up a new Pixelfed server, there is handful of commands you need to run once (and only once) - these are called "),e("a",{href:"./../../generic/installation.html#one-time-setup-tasks"},"One-time setup tasks"),i(".")],-1),J=e("p",null,[i("These steps are now automatically run for you when "),e("a",{href:"./../installation.html"},"creating a new Pixelfed server"),i(".")],-1),Q={id:"extensive-documentation",tabindex:"-1"},ee=e("a",{class:"header-anchor",href:"#extensive-documentation","aria-label":'Permalink to "Extensive documentation <Badge type="tip" text="New" />"'},"​",-1),ie=e("p",null,[i("How to run and use the new Docker setup has been documented extensively. Not only on "),e("em",null,"this"),i(" page, but also in all the new scripts, "),e("code",null,"Dockerfile"),i(", and "),e("code",null,".env.docker"),i(" file.")],-1),se=e("p",null,[i("We hope this will make it much easier to confidently and comfortably run your Pixelfed server with Docker - and when things "),e("em",null,"do"),i(" go wrong, the debugging and fixing of the issue much easier and quicker.")],-1),ae={id:"automatic-publishing-of-docker-images",tabindex:"-1"},te=e("a",{class:"header-anchor",href:"#automatic-publishing-of-docker-images","aria-label":'Permalink to "Automatic publishing of Docker images <Badge type="tip" text="Improved" />"'},"​",-1),oe=t("",4),ne={id:"customizable-dockerfile",tabindex:"-1"},le=e("code",null,"Dockerfile",-1),re=e("a",{class:"header-anchor",href:"#customizable-dockerfile","aria-label":'Permalink to "Customizable `Dockerfile` <Badge type="tip" text="New" />"'},"​",-1),he=t("",4),de={id:"customizable-entrypoint",tabindex:"-1"},pe=e("code",null,"ENTRYPOINT",-1),ce=e("a",{class:"header-anchor",href:"#customizable-entrypoint","aria-label":'Permalink to "Customizable `ENTRYPOINT` <Badge type="tip" text="New" />"'},"​",-1),ke=e("p",null,[i("Do you want to "),e("a",{href:"./../customize.html#run-script-on-startup"},"run a script on container start up?"),i(" Or perhaps to "),e("a",{href:"./../customize.html#disabling-entrypoint-or-individual-scripts"},"disable a specific init script?"),i(" Or even "),e("a",{href:"./../customize.html#disabling-entrypoint-or-individual-scripts"},"disable all of the init scripts?")],-1),ue=e("p",null,[i("Now you can! And like with all the other settings it's just a setting in your "),e("code",null,".env"),i(" file!")],-1),ge={id:"templating-files",tabindex:"-1"},me=e("a",{class:"header-anchor",href:"#templating-files","aria-label":'Permalink to "Templating files <Badge type="tip" text="New" />"'},"​",-1),ye=e("p",null,[i("The new "),e("code",null,"ENTRYPOINT"),i(" system offers an "),e("a",{href:"./../customize.html#templating"},"extensible and flexible way for you to template configuration files"),i(" such as your "),e("code",null,"php.ini"),i(" during container start up.")],-1),fe=e("p",null,[i("The templating system has access to all settings from your "),e("code",null,".env"),i(" file, and you can "),e("a",{href:"./../customize.html#file-path-examples"},"easily add your own templates!")],-1),be={id:"automatic-php-web-server-configuration",tabindex:"-1"},Fe=e("a",{class:"header-anchor",href:"#automatic-php-web-server-configuration","aria-label":'Permalink to "Automatic PHP/Web server configuration <Badge type="tip" text="New" />"'},"​",-1),_e=t("",2),ve={id:"permission-auto-fixing",tabindex:"-1"},Ce=e("a",{class:"header-anchor",href:"#permission-auto-fixing","aria-label":'Permalink to "Permission auto-fixing <Badge type="tip" text="New" />"'},"​",-1),we=e("p",null,[i("If your installation for some reason has issues with permissions to files/directories, you can now automatically "),e("a",{href:"./../customize.html#fixing-ownership-on-startup"},"fix ownership and permissions on start up"),i(".")],-1),Ee=e("p",null,"This is an opt-in feature.",-1),Be={id:"faster-docker-image-building",tabindex:"-1"},Te=e("a",{class:"header-anchor",href:"#faster-docker-image-building","aria-label":'Permalink to "Faster Docker image building <Badge type="tip" text="Improved" />"'},"​",-1),Pe=t("",2),xe={id:"fork-friendly-docker-releasing",tabindex:"-1"},Ae=e("a",{class:"header-anchor",href:"#fork-friendly-docker-releasing","aria-label":'Permalink to "Fork friendly Docker releasing <Badge type="tip" text="New" />"'},"​",-1),De=t("",123);function Oe(Ne,Re,Ie,Se,qe,He){const s=n("Badge");return r(),l("div",null,[d,e("h3",p,[i("New "),c,i(),a(s,{type:"danger",text:"Breaking"}),i(),k]),u,g,e("h3",m,[i("New Docker Compose file "),a(s,{type:"danger",text:"Breaking"}),i(),y]),f,b,e("h3",F,[i("New "),_,i(" / "),v,i(" file "),a(s,{type:"danger",text:"Breaking"}),i(),C]),w,E,e("h3",B,[i("Using "),T,i(" volumes "),a(s,{type:"danger",text:"Breaking"}),i(),P]),x,e("h3",A,[i("No Docker networks "),a(s,{type:"danger",text:"Breaking change"}),i(),D]),O,e("h3",N,[i("New Redis version "),a(s,{type:"warning",text:"Attention needed"}),i(),R]),I,e("h3",S,[i("Pinned MariaDB version "),a(s,{type:"warning",text:"Attention needed"}),i(),q]),H,L,e("h3",M,[i('Automatic "One-time setup tasks" '),a(s,{type:"warning",text:"Attention needed"}),i(),V]),K,e("h3",z,[i("Nginx Proxy service "),a(s,{type:"tip",text:"New"}),i(),U]),W,e("h3",G,[i("LetsEncrypt/ACME service "),a(s,{type:"tip",text:"New"}),i(),Y]),$,e("h3",j,[i('Automatic run of "One-time setup tasks" '),a(s,{type:"tip",text:"New"}),i(),X]),Z,J,e("h3",Q,[i("Extensive documentation "),a(s,{type:"tip",text:"New"}),i(),ee]),ie,se,e("h3",ae,[i("Automatic publishing of Docker images "),a(s,{type:"tip",text:"Improved"}),i(),te]),oe,e("h3",ne,[i("Customizable "),le,i(),a(s,{type:"tip",text:"New"}),i(),re]),he,e("h3",de,[i("Customizable "),pe,i(),a(s,{type:"tip",text:"New"}),i(),ce]),ke,ue,e("h3",ge,[i("Templating files "),a(s,{type:"tip",text:"New"}),i(),me]),ye,fe,e("h3",be,[i("Automatic PHP/Web server configuration "),a(s,{type:"tip",text:"New"}),i(),Fe]),_e,e("h3",ve,[i("Permission auto-fixing "),a(s,{type:"tip",text:"New"}),i(),Ce]),we,Ee,e("h3",Be,[i("Faster Docker image building "),a(s,{type:"tip",text:"Improved"}),i(),Te]),Pe,e("h3",xe,[i("Fork friendly Docker releasing "),a(s,{type:"tip",text:"New"}),i(),Ae]),De])}const Ve=o(h,[["render",Oe]]);export{Me as __pageData,Ve as default};
